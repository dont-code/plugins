(self.webpackChunkplugin_tester=self.webpackChunkplugin_tester||[]).push([[9500,5861],{49500:(W,v,m)=>{m.r(v),m.d(v,{BasicEntityComponent:()=>A,BasicFieldsComponent:()=>k,BasicModule:()=>G,DontCodeApiStoreProvider:()=>S,TimeFieldsComponent:()=>O,WebFieldsComponent:()=>Q});var d=m(57863),c=m(26282);class T{getConfiguration(){return{plugin:{id:"BasicPlugin","display-name":"Dont code plugin for all base elements",version:"1.0.0"},"schema-updates":[{id:"entity-all",description:"Screens to directly list, edit, remove entities",changes:[{location:{parent:"#/$defs",id:"entity"},replace:!1}]},{id:"dont-code-storage",description:"Stores application data in Dont-code project storage",changes:[{location:{parent:"#/$defs/sharing",id:"with"},replace:!1,update:{enum:["Dont-code users"]}}]}],"preview-handlers":[{location:{parent:c.DontCodeModel.APP_ENTITIES,id:""},class:{name:"BasicEntityComponent",source:"basic"}},{location:{parent:c.DontCodeModel.APP_FIELDS,id:"type",values:["String","Number","Boolean"]},class:{name:"BasicFieldsComponent",source:"basic"}},{location:{parent:c.DontCodeModel.APP_FIELDS,id:"type",values:["Date","Date & Time","Time"]},class:{name:"TimeFieldsComponent",source:"basic"}},{location:{parent:c.DontCodeModel.APP_FIELDS,id:"type",values:["Website (url)","Image"]},class:{name:"WebFieldsComponent",source:"basic"}},{location:{parent:c.DontCodeModel.APP_SHARING,id:"with",values:["Dont-code users"]},class:{name:"DontCodeApiStoreProvider",source:"basic"}}]}}pluginInit(a){}}var g=m(15861),s=m(33272),_=m(2369),e=m(30549),f=m(72655),h=m(3134),u=m(51411);function y(i,a){if(1&i&&(e.\u0275\u0275elementStart(0,"th",4),e.\u0275\u0275text(1),e.\u0275\u0275element(2,"p-sortIcon",5),e.\u0275\u0275elementEnd()),2&i){const o=a.$implicit;e.\u0275\u0275propertyInterpolate1("id","header-",o.header,""),e.\u0275\u0275property("pSortableColumn",o.field),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",o.header," "),e.\u0275\u0275advance(1),e.\u0275\u0275property("field",o.field)}}function x(i,a){if(1&i&&(e.\u0275\u0275elementStart(0,"tr"),e.\u0275\u0275template(1,y,3,4,"th",3),e.\u0275\u0275elementEnd()),2&i){const o=a.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",o)}}function H(i,a){1&i&&e.\u0275\u0275elementContainer(0)}function J(i,a){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,H,1,0,"ng-container",9),e.\u0275\u0275elementContainerEnd()),2&i){const o=e.\u0275\u0275nextContext().$implicit,t=e.\u0275\u0275nextContext().$implicit,n=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",n.templateOf(o,t[o.field]))}}function z(i,a){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"span",10),e.\u0275\u0275pipe(2,"beautifier"),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"beautifier"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()),2&i){const o=e.\u0275\u0275nextContext().$implicit,t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("pTooltip",e.\u0275\u0275pipeBind1(2,2,t[o.field])),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind2(4,4,t[o.field],50))}}function Z(i,a){if(1&i&&(e.\u0275\u0275elementStart(0,"td"),e.\u0275\u0275template(1,J,2,1,"ng-container",8),e.\u0275\u0275template(2,z,5,7,"ng-container",8),e.\u0275\u0275elementEnd()),2&i){const o=a.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.component),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!o.component)}}function $(i,a){if(1&i&&(e.\u0275\u0275elementStart(0,"tr",6),e.\u0275\u0275template(1,Z,3,2,"td",7),e.\u0275\u0275elementEnd()),2&i){const t=a.columns;e.\u0275\u0275property("pSelectableRow",a.$implicit),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t)}}let D=(()=>{var i;class a extends s.PluginBaseComponent{constructor(t,n,r,l){super(r,n,t),this.modelMgr=l,this.selectedItemChange=new e.EventEmitter,this.cols=new Array,this.colsMap=new Map,this.store=null,null==this.modelMgr&&(this.modelMgr=c.dtcde.getModelManager())}selectionChange(t){this.selectedItemChange.emit(t)}initCommandFlow(t,n){if(super.initCommandFlow(t,n),!this.entityPointer)throw new Error("Cannot listen to changes without knowing a base position");this.decomposeJsonToMultipleChanges(this.entityPointer,t.getJsonAt(this.entityPointer.position)),this.initChangeListening(!0)}handleChange(t){t.position!==this.entityPointer?.position&&this.applyUpdatesToArrayAsync(this.cols,this.colsMap,t,null,(n,r)=>this.loadSubComponent(n,r.type,r.name,this.provider?.getJsonAt(n.position)).then(l=>{const C=new K(r.name,r.name,r.type);return l&&l.canProvide(r.type).forInlineView&&(C.component=l,this.applyComponentToSubField(l,r.type,r.name)),C})).then(n=>{this.cols=n,this.ref.markForCheck(),this.ref.detectChanges()})}performAction(t){var n=this;return(0,g.Z)(function*(){if(null==t.pointer)return Promise.reject("No pointer for Action with position "+t.position);if(t.position==n.entityPointer?.position&&null!=n.store?.entities)for(const r of n.cols)if(null!=r.component?.performAction)for(const l of n.store?.entities)r.component?.setValue(l[r.field]),yield r.component.performAction(t)})()}retrieveColumnInfo(t){const n=this.colsMap.get(t);if(null!=n)return this.cols[n];throw new Error("Cannot find column with name "+t)}providesTemplates(){return new s.TemplateList(null,null,null)}canProvide(t){return new s.PossibleTemplateList(!1,!1,!1)}templateOf(t,n){if(null!=t.component){t.component.setValue(n);const r=t.component.providesTemplates(t.type).forInlineView;if(r)return r}throw new Error("No component or template to display "+t.type)}getStoreEntities(){return this.store?.entities?this.store.entities:[]}dataIsLoaded(){let t=this.getStoreEntities();if(t?.length>0){const n=new Array;n.push(...this.cols.map(l=>l.field));let r=0;for(;n.length>0&&r<t.length;){for(let l=0;l<n.length;l++)null!=t[r][n[l]]&&(n.splice(l,1),l--);r++}if(n.length>0&&n.length<this.cols.length)for(let l=0;l<this.cols.length;l++)if(n.indexOf(this.cols[l].field)>=0){this.cols.splice(l,1);for(let b of this.colsMap.entries())if(b[1]===l){this.colsMap.delete(b[0]);break}}}}customSort(t){null!=t.field&&null!=t.data&&this.modelMgr.sortValues(t.data,t.order,t.field)}}return(i=a).\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(e.Injector),e.\u0275\u0275directiveInject(s.ComponentLoaderService),e.\u0275\u0275directiveInject(c.DontCodeModelManager))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["dontcode-list-entity"]],inputs:{selectedItem:"selectedItem",store:"store"},outputs:{selectedItemChange:"selectedItemChange"},features:[e.\u0275\u0275InheritDefinitionFeature],decls:4,vars:4,consts:[["styleClass","p-datatable-striped","responsiveLayout","scroll","selectionMode","single",3,"columns","value","selection","customSort","selectionChange","sortFunction"],["pTemplate","header"],["pTemplate","body"],[3,"id","pSortableColumn",4,"ngFor","ngForOf"],[3,"id","pSortableColumn"],[3,"field"],[3,"pSelectableRow"],[4,"ngFor","ngForOf"],[4,"ngIf"],[4,"ngTemplateOutlet"],[3,"pTooltip"]],template:function(t,n){1&t&&(e.\u0275\u0275element(0,"dtcde-dynamic"),e.\u0275\u0275elementStart(1,"p-table",0),e.\u0275\u0275listener("selectionChange",function(l){return n.selectedItem=l})("selectionChange",function(l){return n.selectionChange(l)})("sortFunction",function(l){return n.customSort(l)}),e.\u0275\u0275template(2,x,2,1,"ng-template",1),e.\u0275\u0275template(3,$,2,2,"ng-template",2),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("columns",n.cols)("value",n.getStoreEntities())("selection",n.selectedItem)("customSort",!0))},dependencies:[d.NgForOf,d.NgIf,d.NgTemplateOutlet,f.Table,h.PrimeTemplate,f.SortableColumn,f.SelectableRow,f.SortIcon,u.Tooltip,s.DynamicInsertPoint,s.BeautifierPipe]}),a})();class K{constructor(a,o,t){this.field=a,this.header=o,this.type=t,this.component=null}}var p=m(27022),E=m(49162),P=m(30178);const X=["defaulteditor"];function Y(i,a){1&i&&e.\u0275\u0275elementContainer(0)}const q=function(i){return{fieldName:i}};function ee(i,a){if(1&i&&(e.\u0275\u0275elementStart(0,"div",4)(1,"div",5)(2,"label",6),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div"),e.\u0275\u0275template(5,Y,1,0,"ng-container",7),e.\u0275\u0275elementEnd()()()),2&i){const o=a.$implicit,t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(2),e.\u0275\u0275property("for",o.name),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(o.name),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngTemplateOutlet",t.templateOf(o))("ngTemplateOutletContext",e.\u0275\u0275pureFunction1(4,q,o.name))}}function te(i,a){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"form",2),e.\u0275\u0275template(2,ee,6,6,"div",3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()),2&i){const o=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("formGroup",o.form),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",o.getSubFields())}}function ne(i,a){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275element(1,"input",10),e.\u0275\u0275elementContainerEnd()),2&i){const o=e.\u0275\u0275nextContext().fieldName;e.\u0275\u0275advance(1),e.\u0275\u0275property("name",o)("formControlName",o)}}function oe(i,a){if(1&i&&e.\u0275\u0275element(0,"textarea",11),2&i){const o=e.\u0275\u0275nextContext().fieldName;e.\u0275\u0275property("name",o)("formControlName",o)("autoResize",!0)}}function ie(i,a){if(1&i&&(e.\u0275\u0275elementContainerStart(0,2),e.\u0275\u0275template(1,ne,2,2,"ng-container",8),e.\u0275\u0275template(2,oe,1,3,"ng-template",null,9,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementContainerEnd()),2&i){const o=a.fieldName,t=e.\u0275\u0275reference(3),n=e.\u0275\u0275nextContext();e.\u0275\u0275property("formGroup",n.form),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.isShortText(o))("ngIfElse",t)}}let N=(()=>{var i;class a extends s.PluginBaseComponent{set _value(t){this.setValue(t)}constructor(t,n,r,l){super(l,r,t),this.fb=n}ngOnInit(){this.form=this.fb.group({},{updateOn:"blur"}),this.updateValueOnFormChanges()}initCommandFlow(t,n){if(super.initCommandFlow(t,n),!this.entityPointer)throw new Error("Cannot listen to changes without knowing a base position");this.decomposeJsonToMultipleChanges(this.entityPointer,t.getJsonAt(this.entityPointer.position)),this.initChangeListening(!0),this.rebuildForm()}handleChange(t){t.position!==this.entityPointer?.position&&this.updateSubFieldsWithChange(t,null).then(n=>{null!=n&&(this.ref.markForCheck(),this.ref.detectChanges())})}providesTemplates(){return new s.TemplateList(null,null,null)}canProvide(t){return new s.PossibleTemplateList(!1,!1,!1)}templateOf(t){let n=t.component?.providesTemplates(t.type).forFullEdit;return n||(n=this.defaultTemplate),n}setForm(t){if(t)throw new Error("Trying to set a form to the Edit Entity component who already has one")}isShortText(t){const n=this.form.get(t)?.value;return null==n||n.length<50}getValue(){return super.getValue()}}return(i=a).\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(p.FormBuilder),e.\u0275\u0275directiveInject(e.Injector),e.\u0275\u0275directiveInject(s.ComponentLoaderService))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["dontcode-edit-entity"]],viewQuery:function(t,n){if(1&t&&e.\u0275\u0275viewQuery(X,5),2&t){let r;e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(n.defaultTemplate=r.first)}},inputs:{_value:["value","_value"]},features:[e.\u0275\u0275InheritDefinitionFeature],decls:4,vars:1,consts:[[4,"ngIf"],["defaulteditor",""],[3,"formGroup"],["class","formgrid grid",4,"ngFor","ngForOf"],[1,"formgrid","grid"],[1,"field","col-12"],[3,"for"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"ngIf","ngIfElse"],["smallText",""],["pInputText","",1,"w-full",3,"name","formControlName"],["pInputTextarea","",3,"name","formControlName","autoResize"]],template:function(t,n){1&t&&(e.\u0275\u0275element(0,"dtcde-dynamic"),e.\u0275\u0275template(1,te,3,2,"ng-container",0),e.\u0275\u0275template(2,ie,4,3,"ng-template",null,1,e.\u0275\u0275templateRefExtractor)),2&t&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.value))},dependencies:[d.NgForOf,d.NgIf,d.NgTemplateOutlet,p.\u0275NgNoValidate,p.DefaultValueAccessor,p.NgControlStatus,p.NgControlStatusGroup,E.InputText,p.FormGroupDirective,p.FormControlName,s.DynamicInsertPoint,P.InputTextarea]}),a})();var w=m(59641),M=m(42736),R=m(24504);function re(i,a){if(1&i){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",6),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(o);const n=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(n.newEntity())}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(1,"button",7),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(o);const n=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(n.deleteEntity())}),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(2,"i",8),e.\u0275\u0275elementStart(3,"button",9),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(o);const n=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(n.refreshScreen())}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"button",10),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(o);const n=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(n.saveEntity())}),e.\u0275\u0275elementEnd()}if(2&i){const o=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate1("pTooltip","Create a new ",o.entityName,"."),e.\u0275\u0275property("disabled",o.dataLoading),e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate1("pTooltip","Remove permanently the selected ",o.entityName,"."),e.\u0275\u0275property("disabled",!o.selectedItem),e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate1("pTooltip","Refresh values of all ",o.entityName,"."),e.\u0275\u0275property("icon",o.refreshIcon)("disabled",o.dataLoading),e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate1("pTooltip","Saves permanently the selected ",o.entityName,"."),e.\u0275\u0275property("disabled",!o.canSave)}}function ae(i,a){if(1&i){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",11),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(o);const n=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(n.newEntity())}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(1,"button",12),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(o);const n=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(n.deleteEntity())}),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(2,"i",8),e.\u0275\u0275elementStart(3,"button",13),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(o);const n=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(n.refreshScreen())}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"button",14),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(o);const n=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(n.saveEntity())}),e.\u0275\u0275elementEnd()}if(2&i){const o=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate1("pTooltip","Create a new ",o.entityName,"."),e.\u0275\u0275property("disabled",o.dataLoading),e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate1("pTooltip","Remove permanently the selected ",o.entityName,"."),e.\u0275\u0275property("disabled",!o.selectedItem),e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate1("pTooltip","Refresh values of all ",o.entityName,"."),e.\u0275\u0275property("icon",o.refreshIcon)("disabled",o.dataLoading),e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate1("pTooltip","Saves permanently the selected ",o.entityName,"."),e.\u0275\u0275property("disabled",!o.canSave)}}let A=(()=>{var i;class a extends s.PluginBaseComponent{constructor(t,n,r,l){super(r,l,n),this.entityService=t,this.entityName="",this.canSave=!1,this.store=null,this.tabIndex=0,this.dataLoading=!1,this.refreshIcon=a.baseRefreshIcons}initCommandFlow(t,n){if(super.initCommandFlow(t,n),this.entityPointer){const r=t.getJsonAt(this.entityPointer.position);this.store=this.entityService.retrieveListManager(this.entityPointer,r),this.decomposeJsonToMultipleChanges(this.entityPointer,r)}this.initChangeListening()}ngAfterViewInit(){if(!this.entityPointer||!this.provider)throw new Error("Cannot create subcomponents before initCommandFlow is called");this.list.initCommandFlow(this.provider,this.entityPointer.subPropertyPointer(c.DontCodeModel.APP_FIELDS_NODE)),this.edit.initCommandFlow(this.provider,this.entityPointer.subPropertyPointer(c.DontCodeModel.APP_FIELDS_NODE)),null!=this.store&&this.store.loadAll().then(()=>{console.debug("Loaded entities");try{this.list.dataIsLoaded()}catch{console.debug("Just ignore errors when calling dataIsloaded")}this.ref.markForCheck(),this.ref.detectChanges()},t=>{this.ref.markForCheck(),this.ref.detectChanges()}),super.ngAfterViewInit()}initChangeListening(){if(super.initChangeListening(),!this.provider)throw new Error("Cannot create subcomponents before initCommandFlow is called");this.subscriptions.add(this.provider.receiveCommands(c.DontCodeModel.APP_SHARING_WITH).pipe((0,_.map)(t=>{this.store?(console.debug("Reloading data due to change of StoreManager"),this.store.reset(),this.store.loadAll().then(()=>{try{this.list.dataIsLoaded()}catch{console.debug("Just ignore errors when calling dataIsloaded")}this.ref.markForCheck(),this.ref.detectChanges()},n=>{this.ref.markForCheck(),this.ref.detectChanges()})):console.error("Cannot reload data because store is not set")})).subscribe())}handleChange(t){if(!t.pointer){if(!this.provider)throw new Error("Cannot handle change with no pointer for position"+t.position);t.pointer=this.provider.calculatePointerFor(t.position)}if(!this.entityPointer)throw new Error("Need an entityPointer to handle change @"+t.position);{const n=t.pointer.isUnderSubItemOf(this.entityPointer);if(n){if(n!==c.DontCodeModel.APP_ENTITIES_NAME_NODE)return;this.entityName=t.value}this.ref.markForCheck(),this.ref.detectChanges()}}selectChange(t){var n=this;return(0,g.Z)(function*(){t?(null!=n.store&&(yield n.store.loadDetailOf(t).then(r=>{null!=r&&(n.selectedItem=r)}).catch(r=>{console.error("Ignoring the failed loading of "+t._id+" due to ",r)})),n.canSave=!0,n.tabIndex=1):n.canSave=!1,n.ref.markForCheck(),n.ref.detectChanges()})()}deleteEntity(){var t=this;return(0,g.Z)(function*(){t.selectedItem&&t.store&&(yield t.store.remove(t.selectedItem).then(n=>{t.selectedItem=null,t.canSave=!1,t.tabIndex=0,t.ref.markForCheck(),t.ref.detectChanges()}))})()}newEntity(){const t={};this.store?.push(t),this.selectedItem=t,this.canSave=!0,this.tabIndex=1}saveEntity(){var t=this;return(0,g.Z)(function*(){if(t.selectedItem){t.canSave=!1;try{t.edit.getValue(),yield t.store?.store(t.selectedItem).then(n=>{console.debug("Entity named ",t.entityName+" with value "+n," stored at position "+t.entityPointer?.position),t.selectedItem=n,t.tabIndex=0}).catch(n=>{console.error("Entity named ",t.entityName," not saved because of ",n)})}finally{t.canSave=!0,t.ref.markForCheck(),t.ref.detectChanges()}}})()}providesTemplates(){return new s.TemplateList(null,null,null)}canProvide(t){return new s.PossibleTemplateList(!1,!1,!1)}refreshScreen(){var t=this;return(0,g.Z)(function*(){if(console.debug("Refresh called"),null==t.entityPointer)return Promise.reject("No entityPointer");if(0!=t.tabIndex)return Promise.reject("Not displaying the list");try{t.refreshIcon=a.baseRefreshIcons+" pi-spin",console.debug("Performing action"),yield t.pluginHelper.performAction(new c.Action(t.entityPointer?.position,null,c.ActionContextType.LIST,c.ActionType.EXTRACT,t.entityPointer)),console.debug("Marking for Check"),t.ref.markForCheck(),t.ref.detectChanges(),console.debug("Storing Changed values"),yield t.store?.storeAllChanged(),console.debug("Stored values changed")}catch(n){console.error("Error ",n," performing refresh action on ",t.entityName,t.entityPointer)}finally{t.refreshIcon=a.baseRefreshIcons,t.ref.markForCheck(),t.ref.detectChanges()}})()}}return(i=a).baseRefreshIcons="pi pi-refresh",i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(s.EntityStoreService),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(s.ComponentLoaderService),e.\u0275\u0275directiveInject(e.Injector))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["dontcode-basic-entity"]],viewQuery:function(t,n){if(1&t&&(e.\u0275\u0275viewQuery(D,5),e.\u0275\u0275viewQuery(N,5)),2&t){let r;e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(n.list=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(n.edit=r.first)}},features:[e.\u0275\u0275InheritDefinitionFeature],decls:11,vars:6,consts:[["pTemplate","left"],[3,"activeIndex","activeIndexChange"],["header","List"],[3,"store","selectedItem","selectedItemChange"],["header","Edit",3,"disabled"],[3,"value"],["name","new","pButton","","icon","pi pi-plus",1,"p-button-rounded","p-button-success","p-mr-2",3,"pTooltip","disabled","click"],["name","delete","pButton","","icon","pi pi-trash",1,"p-button-rounded","p-button-warning",3,"pTooltip","disabled","click"],[1,"pi","pi-minus","p-mx-2",2,"font-size","0.5rem"],["name","refresh","pButton","",1,"p-button-rounded","p-button-warning",3,"icon","pTooltip","disabled","click"],["name","save","pButton","","icon","pi pi-save",1,"p-button-rounded","p-button-warning",3,"pTooltip","disabled","click"],["name","new-bottom","pButton","","icon","pi pi-plus",1,"p-button-rounded","p-button-success","p-mr-2",3,"pTooltip","disabled","click"],["name","delete-bottom","pButton","","icon","pi pi-trash",1,"p-button-rounded","p-button-warning",3,"pTooltip","disabled","click"],["name","refresh-bottom","pButton","",1,"p-button-rounded","p-button-warning",3,"icon","pTooltip","disabled","click"],["name","save-bottom","pButton","","icon","pi pi-save",1,"p-button-rounded","p-button-warning",3,"pTooltip","disabled","click"]],template:function(t,n){1&t&&(e.\u0275\u0275elementStart(0,"h1"),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(2,"p-toolbar"),e.\u0275\u0275template(3,re,5,9,"ng-template",0),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"p-tabView",1),e.\u0275\u0275listener("activeIndexChange",function(l){return n.tabIndex=l}),e.\u0275\u0275elementStart(5,"p-tabPanel",2)(6,"dontcode-list-entity",3),e.\u0275\u0275listener("selectedItemChange",function(l){return n.selectedItem=l})("selectedItemChange",function(l){return n.selectChange(l)}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(7,"p-tabPanel",4),e.\u0275\u0275element(8,"dontcode-edit-entity",5),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(9,"p-toolbar"),e.\u0275\u0275template(10,ae,5,9,"ng-template",0),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("List of ",n.entityName,""),e.\u0275\u0275advance(3),e.\u0275\u0275property("activeIndex",n.tabIndex),e.\u0275\u0275advance(2),e.\u0275\u0275property("store",n.store)("selectedItem",n.selectedItem),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",!n.selectedItem),e.\u0275\u0275advance(1),e.\u0275\u0275property("value",n.selectedItem))},dependencies:[h.PrimeTemplate,w.TabView,w.TabPanel,M.Toolbar,R.ButtonDirective,u.Tooltip,D,N],changeDetection:0}),a})();var L=m(6587),B=m(46346);const le=["INPUT"],se=["NUMERIC"],me=["CHECK"],pe=["LIST_CHECK"];function ce(i,a){if(1&i&&(e.\u0275\u0275elementContainerStart(0,4),e.\u0275\u0275element(1,"input",5),e.\u0275\u0275elementContainerEnd()),2&i){const o=e.\u0275\u0275nextContext();e.\u0275\u0275property("formGroup",o.form),e.\u0275\u0275advance(1),e.\u0275\u0275property("name",o.name)("formControlName",o.name)}}function de(i,a){if(1&i&&(e.\u0275\u0275elementContainerStart(0,4),e.\u0275\u0275element(1,"p-inputNumber",6),e.\u0275\u0275elementContainerEnd()),2&i){const o=e.\u0275\u0275nextContext();e.\u0275\u0275property("formGroup",o.form),e.\u0275\u0275advance(1),e.\u0275\u0275property("name",o.name)("formControlName",o.name)("showButtons",!0)}}function ue(i,a){if(1&i&&(e.\u0275\u0275elementContainerStart(0,4),e.\u0275\u0275element(1,"p-checkbox",7),e.\u0275\u0275elementContainerEnd()),2&i){const o=e.\u0275\u0275nextContext();e.\u0275\u0275property("formGroup",o.form),e.\u0275\u0275advance(1),e.\u0275\u0275property("name",o.name)("formControlName",o.name)("binary",!0)}}function fe(i,a){if(1&i&&e.\u0275\u0275element(0,"p-checkbox",8),2&i){const o=e.\u0275\u0275nextContext();e.\u0275\u0275property("readonly",!0)("binary",!0)("ngModel",o.value)}}let k=(()=>{var i;class a extends s.AbstractDynamicComponent{constructor(){super(...arguments),this.control=new p.FormControl(null,{updateOn:"blur"}),this.isJson=!1}setForm(t){super.setForm(t),this.form.registerControl(this.name,this.control)}providesTemplates(t){switch(this.type!=t&&(console.warn("BasicField Type is changed from "+this.type+" to "+t),this.type=t),t){case"Number":return new s.TemplateList(null,null,this.numericTemplate);case"Boolean":return new s.TemplateList(this.listCheckTemplate,null,this.checkTemplate);default:return new s.TemplateList(null,null,this.inputTemplate)}}canProvide(t){return this.type=t,new s.PossibleTemplateList("Boolean"===t,!1,!0)}transformToFormGroupValue(t){return"Text"===this.type&&"string"!=typeof t?(this.isJson=!0,null!=t?JSON.stringify(t,null,2):t):super.transformToFormGroupValue(t)}transformFromFormGroupValue(t){if(!this.isJson)return t;try{return JSON.parse(t)}catch{console.error("Cannot convert field with name "+this.name+" from text String to an object")}}}return(i=a).\u0275fac=function(){let o;return function(n){return(o||(o=e.\u0275\u0275getInheritedFactory(i)))(n||i)}}(),i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["plugins-basic-fields"]],viewQuery:function(t,n){if(1&t&&(e.\u0275\u0275viewQuery(le,5),e.\u0275\u0275viewQuery(se,5),e.\u0275\u0275viewQuery(me,5),e.\u0275\u0275viewQuery(pe,5)),2&t){let r;e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(n.inputTemplate=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(n.numericTemplate=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(n.checkTemplate=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(n.listCheckTemplate=r.first)}},features:[e.\u0275\u0275InheritDefinitionFeature],decls:8,vars:0,consts:[["INPUT",""],["NUMERIC",""],["CHECK",""],["LIST_CHECK",""],[3,"formGroup"],["pInputText","",3,"name","formControlName"],[3,"name","formControlName","showButtons"],[3,"name","formControlName","binary"],[3,"readonly","binary","ngModel"]],template:function(t,n){1&t&&(e.\u0275\u0275template(0,ce,2,3,"ng-template",null,0,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(2,de,2,4,"ng-template",null,1,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(4,ue,2,4,"ng-template",null,2,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(6,fe,1,3,"ng-template",null,3,e.\u0275\u0275templateRefExtractor))},dependencies:[L.Checkbox,p.DefaultValueAccessor,p.NgControlStatus,p.NgControlStatusGroup,p.NgModel,B.InputNumber,E.InputText,p.FormGroupDirective,p.FormControlName]}),a})();var I=m(92256),j=m(16602);let S=(()=>{var i;class a extends c.AbstractDontCodeStoreProvider{constructor(t,n,r,l){super(),this.http=t,this.modelMgr=n,r?this.apiUrl=r:(this.apiUrl="https://test.dont-code.net/data",console.log("DONTCODE_STORE_API_URL token not provided, hence using default test.dont-code.net/data url.")),l?this.docUrl=l:(this.docUrl="https://test.dont-code.net/documents",console.log("DONTCODE_STORE_DOC_URL token not provided, hence using default test.dont-code.net/documents url.")),null==this.modelMgr&&(this.modelMgr=c.dtcde.getModelManager(),console.warn("DontCodeModelManager not found by Angular's DI"))}storeEntity(t,n){const r=this.modelMgr.findAtPosition(t,!1);if(null===r)return Promise.reject("No entity found at position "+t);const l=n._id;return(0,I.lastValueFrom)(null!=l?this.http.put(this.apiUrl+"/"+r.name+"/"+l,n,{observe:"body",responseType:"json"}):this.http.post(this.apiUrl+"/"+r.name,n,{observe:"body",responseType:"json"}))}loadEntity(t,n){const r=this.modelMgr.findAtPosition(t,!1);if(null===r)return Promise.reject("No entity found at position "+t);const l=this.http.get(this.apiUrl+"/"+r.name+"/"+n,{observe:"body",responseType:"json"});return(0,I.lastValueFrom)(l)}deleteEntity(t,n){const r=this.modelMgr.findAtPosition(t,!1);return null===r?Promise.reject("No entity found at position "+t):this.http.delete(this.apiUrl+"/"+r.name+"/"+n,{observe:"body",responseType:"json"}).toPromise().then(l=>!0)}searchEntities(t,...n){const r=this.modelMgr.findAtPosition(t,!1);return null===r?(0,I.throwError)(()=>new Error("No entity found at position "+t)):this.http.get(this.apiUrl+"/"+r.name,{observe:"body",responseType:"json"}).pipe((0,_.map)(l=>c.StoreProviderHelper.applyFilters(l,...n)))}canStoreDocument(t){return!0}storeDocuments(t,n){const r=new FormData,l=new j.HttpHeaders;l.append("Content-Type","multipart/form-data"),l.append("Accept","application/json");let C=0;return t.forEach(b=>{r.append("document#"+C,b),C++}),this.http.post(this.docUrl,r,{headers:l}).pipe((0,_.mergeAll)())}}return(i=a).\u0275fac=function(t){return new(t||i)(e.\u0275\u0275inject(j.HttpClient),e.\u0275\u0275inject(c.DontCodeModelManager,8),e.\u0275\u0275inject(s.DONT_CODE_STORE_API_URL,8),e.\u0275\u0275inject(s.DONT_CODE_DOC_API_URL,8))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac,providedIn:"root"}),a})();var V=m(38570);const he=["EDIT_DATE"],ge=["READ_DATE"],_e=["EDIT_DATE_TIME"],Ce=["READ_DATE_TIME"],ye=["EDIT_TIME"],Te=["READ_TIME"];function ve(i,a){if(1&i){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0,6),e.\u0275\u0275elementStart(1,"p-calendar",7),e.\u0275\u0275listener("onSelect",function(n){e.\u0275\u0275restoreView(o);const r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.dateSelected(r.form,n))}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&i){const o=e.\u0275\u0275nextContext();e.\u0275\u0275property("formGroup",o.form),e.\u0275\u0275advance(1),e.\u0275\u0275property("name",o.name)("formControlName",o.name)}}function Ee(i,a){if(1&i){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0,6),e.\u0275\u0275elementStart(1,"p-calendar",8),e.\u0275\u0275listener("onSelect",function(n){e.\u0275\u0275restoreView(o);const r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.dateSelected(r.form,n))}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&i){const o=e.\u0275\u0275nextContext();e.\u0275\u0275property("formGroup",o.form),e.\u0275\u0275advance(1),e.\u0275\u0275property("name",o.name)("formControlName",o.name)("showTime",!0)}}function Ie(i,a){if(1&i){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0,6),e.\u0275\u0275elementStart(1,"p-calendar",9),e.\u0275\u0275listener("onSelect",function(n){e.\u0275\u0275restoreView(o);const r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.dateSelected(r.form,n))}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&i){const o=e.\u0275\u0275nextContext();e.\u0275\u0275property("formGroup",o.form),e.\u0275\u0275advance(1),e.\u0275\u0275property("name",o.name)("formControlName",o.name)("timeOnly",!0)}}function be(i,a){if(1&i&&(e.\u0275\u0275elementStart(0,"span",10),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){const o=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("pTooltip",o.localizeLongDate(o.value)),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(o.localizeShortDate(o.value))}}function xe(i,a){if(1&i&&(e.\u0275\u0275elementStart(0,"span",10),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){const o=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("pTooltip",o.localizeLongDate(o.value)),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(o.localizeShortDate(o.value))}}function we(i,a){if(1&i&&(e.\u0275\u0275elementStart(0,"span",10),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){const o=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("pTooltip",o.localizeLongDate(o.value)),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(o.localizeShortDate(o.value))}}let O=(()=>{var i;class a extends s.AbstractDynamicComponent{constructor(){super(...arguments),this.longConverter=Intl.DateTimeFormat(navigator.language,{weekday:"long",day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:"long"}),this.shortConverter=Intl.DateTimeFormat(navigator.language,{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:"short"})}providesTemplates(t){switch(this.updateConverters(t),t){case"Date":return new s.TemplateList(this.readDateTemplate,null,this.editDateTemplate);case"Date & Time":return new s.TemplateList(this.readDateTimeTemplate,null,this.editDateTimeTemplate);default:return new s.TemplateList(this.readTimeTemplate,null,this.editTimeTemplate)}}updateConverters(t){switch(t){case"Date":this.longConverter=Intl.DateTimeFormat(navigator.language,{weekday:"long",day:"numeric",month:"long",year:"numeric"}),this.shortConverter=Intl.DateTimeFormat(navigator.language,{day:"2-digit",month:"2-digit",year:"numeric"});break;case"Date & Time":this.longConverter=Intl.DateTimeFormat(navigator.language,{weekday:"long",day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:"long"}),this.shortConverter=Intl.DateTimeFormat(navigator.language,{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:"short"});break;default:this.longConverter=Intl.DateTimeFormat(navigator.language,{hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:"long"}),this.shortConverter=Intl.DateTimeFormat(navigator.language,{hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:"short"})}}localizeLongDate(t){return this.longConverter.format(t)}localizeShortDate(t){return this.shortConverter.format(t)}canProvide(t){switch(t){case"Date":case"Date & Time":case"Time":return new s.PossibleTemplateList(!0,!1,!0);default:return new s.PossibleTemplateList(!1,!1,!1)}}dateSelected(t,n){console.log("Selection:",n);const l=t.get(this.name);null!=l?(l.setValue(n),l.markAsDirty()):console.error("Cannot set date of unknown form control with name "+this.name)}}return(i=a).\u0275fac=function(){let o;return function(n){return(o||(o=e.\u0275\u0275getInheritedFactory(i)))(n||i)}}(),i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["plugins-time-fields"]],viewQuery:function(t,n){if(1&t&&(e.\u0275\u0275viewQuery(he,7),e.\u0275\u0275viewQuery(ge,7),e.\u0275\u0275viewQuery(_e,7),e.\u0275\u0275viewQuery(Ce,7),e.\u0275\u0275viewQuery(ye,7),e.\u0275\u0275viewQuery(Te,7)),2&t){let r;e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(n.editDateTemplate=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(n.readDateTemplate=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(n.editDateTimeTemplate=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(n.readDateTimeTemplate=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(n.editTimeTemplate=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(n.readTimeTemplate=r.first)}},features:[e.\u0275\u0275InheritDefinitionFeature],decls:12,vars:0,consts:[["EDIT_DATE",""],["EDIT_DATE_TIME",""],["EDIT_TIME",""],["READ_DATE",""],["READ_DATE_TIME",""],["READ_TIME",""],[3,"formGroup"],[3,"name","formControlName","onSelect"],[3,"name","formControlName","showTime","onSelect"],[3,"name","formControlName","timeOnly","onSelect"],[3,"pTooltip"]],template:function(t,n){1&t&&(e.\u0275\u0275template(0,ve,2,3,"ng-template",null,0,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(2,Ee,2,4,"ng-template",null,1,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(4,Ie,2,4,"ng-template",null,2,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(6,be,2,2,"ng-template",null,3,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(8,xe,2,2,"ng-template",null,4,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(10,we,2,2,"ng-template",null,5,e.\u0275\u0275templateRefExtractor))},dependencies:[p.NgControlStatus,p.NgControlStatusGroup,p.FormGroupDirective,p.FormControlName,V.Calendar,u.Tooltip]}),a})();var F=m(33790),U=m(52009);const Se=["EDIT_URL"],Fe=["READ_URL"],De=["EDIT_IMAGE"],Pe=["READ_IMAGE"];function Ne(i,a){if(1&i&&(e.\u0275\u0275elementContainerStart(0,5),e.\u0275\u0275element(1,"input",6),e.\u0275\u0275elementContainerEnd()),2&i){const o=e.\u0275\u0275nextContext();e.\u0275\u0275property("formGroup",o.form),e.\u0275\u0275advance(1),e.\u0275\u0275property("name",o.name)("formControlName",o.name)}}function Me(i,a){if(1&i){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"p-fileUpload",11),e.\u0275\u0275listener("uploadHandler",function(n){e.\u0275\u0275restoreView(o);const r=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(r.uploadImage(n))}),e.\u0275\u0275elementEnd()}if(2&i){const o=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("name",o.name+"-img")("auto",!0)("multiple",!1)("customUpload",!0)}}function Re(i,a){if(1&i&&(e.\u0275\u0275elementContainerStart(0,5),e.\u0275\u0275elementStart(1,"div",7)(2,"div",8),e.\u0275\u0275template(3,Me,1,4,"p-fileUpload",9),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",10),e.\u0275\u0275element(5,"input",6),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementContainerEnd()),2&i){const o=e.\u0275\u0275nextContext();e.\u0275\u0275property("formGroup",o.form),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",o.supportsImageUpload()),e.\u0275\u0275advance(2),e.\u0275\u0275property("name",o.name)("formControlName",o.name)}}function Ae(i,a){if(1&i&&(e.\u0275\u0275elementStart(0,"a",12),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){const o=e.\u0275\u0275nextContext();e.\u0275\u0275property("pTooltip",o.value)("href",o.value,e.\u0275\u0275sanitizeUrl),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(o.calculateUrl(o.value))}}function Le(i,a){if(1&i&&e.\u0275\u0275element(0,"img",13),2&i){const o=e.\u0275\u0275nextContext();e.\u0275\u0275property("src",o.value,e.\u0275\u0275sanitizeUrl)}}let Q=(()=>{var i;class a extends s.AbstractDynamicComponent{constructor(t,n,r){super(),this.confirm=t,this.storeMgr=n,this.ref=r,null==this.storeMgr&&(this.storeMgr=c.dtcde.getStoreManager(),console.warn("DontCodeStoreManager not found by Angular's Injector"))}providesTemplates(t){return"Website (url)"===t?new s.TemplateList(this.readUrlTemplate,null,this.editUrlTemplate):new s.TemplateList(this.readImageTemplate,null,this.editImageTemplate)}canProvide(t){switch(t){case"Website (url)":case"Image":return new s.PossibleTemplateList(!0,!1,!0);default:return new s.PossibleTemplateList(!1,!1,!1)}}calculateUrl(t){return t&&(t.includes("//")&&(t=t.substring(t.indexOf("//")+2)),t.length>20?t.substring(0,17)+"...":t)}supportsImageUpload(){return this.storeMgr.canStoreDocument(this.parentPosition||void 0)}uploadImage(t){console.info("Uploading image",t),this.form.get(this.name)?.setValue(void 0),this.value=null,this.subscriptions.add(this.storeMgr.storeDocuments(t.files,this.parentPosition||void 0).pipe((0,_.map)(n=>(console.debug("File uploaded:",n.documentId),this.form.get(this.name)?.setValue(n.documentId),this.value=n.documentId,n))).subscribe({error:n=>{this.fileUpload.clear(),this.ref.markForCheck(),this.ref.detectChanges(),this.confirm.confirm({header:"Error",message:"Error:"+JSON.stringify(n,null,4)})},complete:()=>{this.fileUpload.clear(),this.ref.markForCheck(),this.ref.detectChanges()}}))}}return(i=a).\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(h.ConfirmationService),e.\u0275\u0275directiveInject(c.DontCodeStoreManager,8),e.\u0275\u0275directiveInject(e.ChangeDetectorRef))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["plugins-web-fields"]],viewQuery:function(t,n){if(1&t&&(e.\u0275\u0275viewQuery(Se,7),e.\u0275\u0275viewQuery(Fe,7),e.\u0275\u0275viewQuery(De,7),e.\u0275\u0275viewQuery(Pe,7),e.\u0275\u0275viewQuery(F.FileUpload,5)),2&t){let r;e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(n.editUrlTemplate=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(n.readUrlTemplate=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(n.editImageTemplate=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(n.readImageTemplate=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(n.fileUpload=r.first)}},features:[e.\u0275\u0275ProvidersFeature([h.ConfirmationService]),e.\u0275\u0275InheritDefinitionFeature],decls:9,vars:0,consts:[["header","Error","icon","pi pi-exclamation-triangle"],["EDIT_URL",""],["EDIT_IMAGE",""],["READ_URL",""],["READ_IMAGE",""],[3,"formGroup"],["pInputText","",1,"w-full",3,"name","formControlName"],[1,"grid"],[1,"col-2"],["mode","basic","chooseLabel","Browse","accept","image/*",3,"name","auto","multiple","customUpload","uploadHandler",4,"ngIf"],[1,"col-10"],["mode","basic","chooseLabel","Browse","accept","image/*",3,"name","auto","multiple","customUpload","uploadHandler"],["target","_blank",3,"pTooltip","href"],[1,"inline-image",3,"src"]],template:function(t,n){1&t&&(e.\u0275\u0275element(0,"p-confirmDialog",0),e.\u0275\u0275template(1,Ne,2,3,"ng-template",null,1,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(3,Re,6,4,"ng-template",null,2,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(5,Ae,2,3,"ng-template",null,3,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(7,Le,1,1,"ng-template",null,4,e.\u0275\u0275templateRefExtractor))},dependencies:[d.NgIf,p.DefaultValueAccessor,p.NgControlStatus,p.NgControlStatusGroup,E.InputText,p.FormGroupDirective,p.FormControlName,u.Tooltip,F.FileUpload,U.ConfirmDialog],styles:[".inline-image[_ngcontent-%COMP%]{max-height:5em;max-width:10em}.tip-image[_ngcontent-%COMP%]{max-height:50em;max-width:100em}"]}),a})(),G=(()=>{var i;class a{constructor(){console.log("Basic Plugin registering"),c.dtcde.registerPlugin(new T)}exposedPreviewHandlers(){return new Map([["BasicEntityComponent",A],["BasicFieldsComponent",k],["TimeFieldsComponent",O],["WebFieldsComponent",Q],["DontCodeApiStoreProvider",S]])}}return(i=a).\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.\u0275\u0275defineNgModule({type:i,id:"dontcode-plugin/basic"}),i.\u0275inj=e.\u0275\u0275defineInjector({providers:[S],imports:[d.CommonModule,f.TableModule,w.TabViewModule,L.CheckboxModule,p.FormsModule,B.InputNumberModule,E.InputTextModule,M.ToolbarModule,R.ButtonModule,p.ReactiveFormsModule,V.CalendarModule,u.TooltipModule,F.FileUploadModule,U.ConfirmDialogModule,s.PluginCommonModule.forRoot(),P.InputTextareaModule]}),a})();e.\u0275\u0275registerNgModuleType(G,"dontcode-plugin/basic")},15861:(W,v,m)=>{function d(T,g,s,_,e,f,h){try{var u=T[f](h),y=u.value}catch(x){return void s(x)}u.done?g(y):Promise.resolve(y).then(_,e)}function c(T){return function(){var g=this,s=arguments;return new Promise(function(_,e){var f=T.apply(g,s);function h(y){d(f,_,e,h,u,"next",y)}function u(y){d(f,_,e,h,u,"throw",y)}h(void 0)})}}m.d(v,{Z:()=>c})}}]);